---
description: 门禁：数据库迁移（先确认、后执行、可回滚）
agent: build
---

你正在执行一个高风险动作：数据库迁移。

## 目标
$ARGUMENTS

## 强制澄清（缺一不可）
1) 数据库类型与环境：Postgres/MySQL/SQLite？dev/test/stage/prod？
2) 迁移工具链：Alembic/Django/Flyway/Prisma/自研？
3) 是否允许停机？是否需要零停机迁移？
4) 回滚策略：向前修复还是可逆回滚？

## 强制流程
1) 只读分析当前 schema 与迁移历史（先列出你将读取的文件/命令）。
2) 给出迁移方案与风险（锁表、数据回填、索引构建、兼容窗口）。
3) 给出验证方案：迁移前/迁移后检查项与命令。
4) 在没有明确确认前，不执行任何会影响生产数据的命令。

## 审计输出
- !`git status --porcelain`
- !`git diff --stat`

## 完成条件
- 输出最终迁移命令序列 + 验证命令序列 + 回滚/补救步骤。
